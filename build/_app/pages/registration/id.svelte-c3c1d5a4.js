var _e=Object.defineProperty;var x=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var ee=(i,t,l)=>t in i?_e(i,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[t]=l,te=(i,t)=>{for(var l in t||(t={}))pe.call(t,l)&&ee(i,l,t[l]);if(x)for(var l of x(t))me.call(t,l)&&ee(i,l,t[l]);return i};import{S as de,i as ge,s as be,e as L,t as y,j as S,k as T,c as A,a as P,g as v,d as g,l as O,b as G,f as h,F as j,h as F,n as w,o as H,p as $,J as Q,u as he,m as J,X as ke,T as le,ai as W,U as Z,H as X,v as I,w as R,x as B,A as C,aj as re,ak as ie,a8 as $e,a9 as we,G as ye,ac as ve}from"../../chunks/vendor-3b8c650a.js";import{a as Y}from"../../chunks/selectData-be498bc2.js";import{a as Fe,R as Se}from"../../chunks/RegistrationForm-50074901.js";import{B as oe}from"../../chunks/Button-17e544cc.js";import{b as Oe,l as V,c as De,d as Ee}from"../../chunks/stores-a1012c52.js";import{h as Ne}from"../../chunks/index-8490d5e5.js";function se(i,t,l){const e=i.slice();return e[20]=t[l],e}function je(i){let t,l=i[9]("registration.notfound")+"",e,r,f,a=i[9]("error.goBack")+"",n;return{c(){t=L("div"),e=y(l),r=S(),f=L("a"),n=y(a),this.h()},l(u){t=A(u,"DIV",{class:!0});var s=P(t);e=v(s,l),r=O(s),f=A(s,"A",{href:!0,class:!0});var o=P(f);n=v(o,a),o.forEach(g),s.forEach(g),this.h()},h(){G(f,"href","/"),G(f,"class","link"),G(t,"class","center svelte-pts9xi")},m(u,s){h(u,t,s),j(t,e),j(t,r),j(t,f),j(f,n)},p(u,s){s&512&&l!==(l=u[9]("registration.notfound")+"")&&F(e,l),s&512&&a!==(a=u[9]("error.goBack")+"")&&F(n,a)},i:X,o:X,d(u){u&&g(t)}}}function Ie(i){let t,l,e,r,f,a,n,u,s,o=!i[10]&&ne(i);const p=[Ce,Be],_=[];function b(c,k){return c[4].length===0?0:1}l=b(i),e=_[l]=p[l](i);let d=i[5]&&ae(i);function U(c){i[16](c)}function K(c){i[17](c)}let M={disabled:i[3],$$slots:{default:[Ve]},$$scope:{ctx:i}};return i[0]!==void 0&&(M.dto=i[0]),i[6]!==void 0&&(M.changed=i[6]),a=new Se({props:M}),i[15](a),Z.push(()=>re(a,"dto",U)),Z.push(()=>re(a,"changed",K)),{c(){o&&o.c(),t=S(),e.c(),r=S(),d&&d.c(),f=S(),I(a.$$.fragment)},l(c){o&&o.l(c),t=O(c),e.l(c),r=O(c),d&&d.l(c),f=O(c),R(a.$$.fragment,c)},m(c,k){o&&o.m(c,k),h(c,t,k),_[l].m(c,k),h(c,r,k),d&&d.m(c,k),h(c,f,k),B(a,c,k),s=!0},p(c,k){c[10]?o&&(J(),w(o,1,1,()=>{o=null}),H()):o?(o.p(c,k),k&1024&&$(o,1)):(o=ne(c),o.c(),$(o,1),o.m(t.parentNode,t));let q=l;l=b(c),l===q?_[l].p(c,k):(J(),w(_[q],1,1,()=>{_[q]=null}),H(),e=_[l],e?e.p(c,k):(e=_[l]=p[l](c),e.c()),$(e,1),e.m(r.parentNode,r)),c[5]?d?(d.p(c,k),k&32&&$(d,1)):(d=ae(c),d.c(),$(d,1),d.m(f.parentNode,f)):d&&(J(),w(d,1,1,()=>{d=null}),H());const E={};k&8&&(E.disabled=c[3]),k&8390635&&(E.$$scope={dirty:k,ctx:c}),!n&&k&1&&(n=!0,E.dto=c[0],ie(()=>n=!1)),!u&&k&64&&(u=!0,E.changed=c[6],ie(()=>u=!1)),a.$set(E)},i(c){s||($(o),$(e),$(d),$(a.$$.fragment,c),s=!0)},o(c){w(o),w(e),w(d),w(a.$$.fragment,c),s=!1},d(c){o&&o.d(c),c&&g(t),_[l].d(c),c&&g(r),d&&d.d(c),c&&g(f),i[15](null),C(a,c)}}}function ne(i){let t,l;return t=new Y({props:{type:"info",$$slots:{default:[Re]},$$scope:{ctx:i}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const f={};r&8389120&&(f.$$scope={dirty:r,ctx:e}),t.$set(f)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Re(i){let t=i[9]("registration.editingAllowedUntil")+"",l,e,r=i[9]("registration.confirmationAfterDeadline")+"",f,a,n,u=i[9]("registration.clickEdit")+"",s;return{c(){l=y(t),e=S(),f=y(r),a=S(),n=new $e,s=T(),this.h()},l(o){l=v(o,t),e=O(o),f=v(o,r),a=O(o),n=we(o),s=T(),this.h()},h(){n.a=s},m(o,p){h(o,l,p),h(o,e,p),h(o,f,p),h(o,a,p),n.m(u,o,p),h(o,s,p)},p(o,p){p&512&&t!==(t=o[9]("registration.editingAllowedUntil")+"")&&F(l,t),p&512&&r!==(r=o[9]("registration.confirmationAfterDeadline")+"")&&F(f,r),p&512&&u!==(u=o[9]("registration.clickEdit")+"")&&n.p(u)},d(o){o&&g(l),o&&g(e),o&&g(f),o&&g(a),o&&g(s),o&&n.d()}}}function Be(i){let t,l;return t=new Y({props:{type:"warning",$$slots:{default:[Ue]},$$scope:{ctx:i}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const f={};r&8389138&&(f.$$scope={dirty:r,ctx:e}),t.$set(f)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Ce(i){let t,l;return t=new Y({props:{type:"success",$$slots:{default:[Le]},$$scope:{ctx:i}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const f={};r&8389120&&(f.$$scope={dirty:r,ctx:e}),t.$set(f)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function fe(i){let t,l=i[9](i[20].labels[0].dataset.label)+"",e,r,f,a;function n(){return i[12](i[20])}return{c(){t=L("li"),e=y(l),r=S(),this.h()},l(u){t=A(u,"LI",{class:!0});var s=P(t);e=v(s,l),r=O(s),s.forEach(g),this.h()},h(){G(t,"class","svelte-pts9xi")},m(u,s){h(u,t,s),j(t,e),j(t,r),f||(a=ye(t,"click",n),f=!0)},p(u,s){i=u,s&528&&l!==(l=i[9](i[20].labels[0].dataset.label)+"")&&F(e,l)},d(u){u&&g(t),f=!1,a()}}}function Ue(i){let t=i[9]("registration.missingForComplete")+"",l,e,r,f=i[4],a=[];for(let n=0;n<f.length;n+=1)a[n]=fe(se(i,f,n));return{c(){l=y(t),e=S(),r=L("ul");for(let n=0;n<a.length;n+=1)a[n].c()},l(n){l=v(n,t),e=O(n),r=A(n,"UL",{});var u=P(r);for(let s=0;s<a.length;s+=1)a[s].l(u);u.forEach(g)},m(n,u){h(n,l,u),h(n,e,u),h(n,r,u);for(let s=0;s<a.length;s+=1)a[s].m(r,null)},p(n,u){if(u&512&&t!==(t=n[9]("registration.missingForComplete")+"")&&F(l,t),u&530){f=n[4];let s;for(s=0;s<f.length;s+=1){const o=se(n,f,s);a[s]?a[s].p(o,u):(a[s]=fe(o),a[s].c(),a[s].m(r,null))}for(;s<a.length;s+=1)a[s].d(1);a.length=f.length}},d(n){n&&g(l),n&&g(e),n&&g(r),ve(a,n)}}}function Le(i){let t=i[9]("registration.complete")+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&512&&t!==(t=e[9]("registration.complete")+"")&&F(l,t)},d(e){e&&g(l)}}}function ae(i){let t,l;return t=new Y({props:{type:"error",$$slots:{default:[Te]},$$scope:{ctx:i}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const f={};r&8389152&&(f.$$scope={dirty:r,ctx:e}),t.$set(f)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Te(i){let t=i[9](...i[5])+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&544&&t!==(t=e[9](...e[5])+"")&&F(l,t)},d(e){e&&g(l)}}}function Ae(i){let t;return{c(){t=L("div")},l(l){t=A(l,"DIV",{}),P(t).forEach(g)},m(l,e){h(l,t,e)},p:X,i:X,o:X,d(l){l&&g(t)}}}function Pe(i){let t,l;return t=new oe({props:{type:"outline",disabled:i[8],$$slots:{default:[He]},$$scope:{ctx:i}}}),t.$on("click",i[13]),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const f={};r&256&&(f.disabled=e[8]),r&8389120&&(f.$$scope={dirty:r,ctx:e}),t.$set(f)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function He(i){let t=i[9]("registration.form.cancel")+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&512&&t!==(t=e[9]("registration.form.cancel")+"")&&F(l,t)},d(e){e&&g(l)}}}function ue(i){let t,l;return t=new oe({props:{type:"primary",disabled:i[8],$$slots:{default:[Je]},$$scope:{ctx:i}}}),t.$on("click",i[14]),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const f={};r&256&&(f.disabled=e[8]),r&8389128&&(f.$$scope={dirty:r,ctx:e}),t.$set(f)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Je(i){let t=(i[3]?i[9]("registration.form.edit"):i[9]("registration.form.save"))+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&520&&t!==(t=(e[3]?e[9]("registration.form.edit"):e[9]("registration.form.save"))+"")&&F(l,t)},d(e){e&&g(l)}}}function Ve(i){let t,l,e,r,f;const a=[Pe,Ae],n=[];function u(o,p){return o[3]?1:0}t=u(i),l=n[t]=a[t](i);let s=!i[10]&&ue(i);return{c(){l.c(),e=S(),s&&s.c(),r=T()},l(o){l.l(o),e=O(o),s&&s.l(o),r=T()},m(o,p){n[t].m(o,p),h(o,e,p),s&&s.m(o,p),h(o,r,p),f=!0},p(o,p){let _=t;t=u(o),t===_?n[t].p(o,p):(J(),w(n[_],1,1,()=>{n[_]=null}),H(),l=n[t],l?l.p(o,p):(l=n[t]=a[t](o),l.c()),$(l,1),l.m(e.parentNode,e)),o[10]?s&&(J(),w(s,1,1,()=>{s=null}),H()):s?(s.p(o,p),p&1024&&$(s,1)):(s=ue(o),s.c(),$(s,1),s.m(r.parentNode,r))},i(o){f||($(l),$(s),f=!0)},o(o){w(l),w(s),f=!1},d(o){n[t].d(o),o&&g(e),s&&s.d(o),o&&g(r)}}}function Me(i){let t,l=i[9]("registration.yourRegistration")+"",e,r,f,a,n,u;const s=[Ie,je],o=[];function p(_,b){return _[0]?0:_[2]?1:-1}return~(f=p(i))&&(a=o[f]=s[f](i)),{c(){t=L("h1"),e=y(l),r=S(),a&&a.c(),n=T(),this.h()},l(_){t=A(_,"H1",{class:!0});var b=P(t);e=v(b,l),b.forEach(g),r=O(_),a&&a.l(_),n=T(),this.h()},h(){G(t,"class","cover-heading")},m(_,b){h(_,t,b),j(t,e),h(_,r,b),~f&&o[f].m(_,b),h(_,n,b),u=!0},p(_,[b]){(!u||b&512)&&l!==(l=_[9]("registration.yourRegistration")+"")&&F(e,l);let d=f;f=p(_),f===d?~f&&o[f].p(_,b):(a&&(J(),w(o[d],1,1,()=>{o[d]=null}),H()),~f?(a=o[f],a?a.p(_,b):(a=o[f]=s[f](_),a.c()),$(a,1),a.m(n.parentNode,n)):a=null)},i(_){u||($(a),u=!0)},o(_){w(a),u=!1},d(_){_&&g(t),_&&g(r),~f&&o[f].d(_),_&&g(n)}}}function qe(i,t,l){let e,r,f,a;Q(i,V,m=>l(8,e=m)),Q(i,De,m=>l(19,r=m)),Q(i,ke,m=>l(9,f=m)),Q(i,Ee,m=>l(10,a=m));let{dto:n=null}=t;Oe.set(!0);let u,s,o=!1,p=!1,_=[],b=null,d=!1,U=null;async function K(){if(l(5,b=null),await le(),u.reportValidity("#firstName, #lastName, #email, #dateOfBirth, #country, #idCopy, #pieceScore, #pieceDemo, #proofOfPayment")){console.log(`saving registration ${s}`),W(V,e=!0,e);let m=await fetch(new URL("registration.php",r),{method:"POST",body:JSON.stringify(n)}),D=await m.text();if(m.ok&&D==="Registration successfully updated."){let N=new FormData;N.append("reg_key",s);for(let z of Object.entries(n.files))z[1]&&N.append(z[0],z[1][0]);if(m=await fetch(new URL(`files.php?key=${s}`,r),{method:"POST",body:N}),D=await m.text(),m.ok&&D==="File upload successful.")return l(0,n.files.idCopyFile=void 0,n),l(0,n.files.pieceDemoFile=void 0,n),l(0,n.files.pieceScoreFile=void 0,n),l(0,n.files.proofOfPaymentFile=void 0,n),l(6,d=!1),W(V,e=!1,e),l(4,_=u.getInvalid()),!0}if(D==="Invalid form.")l(5,b=["registration.form.error.invalidForm",{}]);else if(D.startsWith("Invalid file type or size:")){const N=D.split(": ").pop();l(5,b=["registration.form.error.fileError",{values:{number:N.split(",").length,files:N}}])}else l(5,b=["registration.form.error.errorOccurred",{}]);W(V,e=!1,e)}return!1}he(async()=>{if(W(V,e=!0,e),s=window.location.search.substring(1),console.log(`loading registration ${s}`),s==="1")l(0,n=JSON.parse('{"reg_key":"1","firstName":"Ernst","lastName":"Haft","email":"ernsthaft@web.de","dateOfBirth":"2001-01-11","country":"DE","pieceTitle":"My piece","pieceDemo":"","pieceScore":"score.pdf","idCopy":"","instrumentation":[[true],[true],[true],[true],[true],[true],[true],[true,true],[false,true],[false],[true],[false],[true,true],[false],[false],[false],[false],[false],[true],[true,true,true,true,true,true],[true,true,true,true,false],[true,true,true,true],[true,false,false],[false,false]],"scoreConfirmations":[true,false,false],"proofOfPayment":"","files":{"idCopyFile":null,"pieceScoreFile":null,"pieceDemoFile":null,"proofOfPaymentFile":null}}'));else{const m=await fetch(new URL(`registration.php?key=${s}`,r));if(m.ok){const D=await m.json();l(0,n=Object.assign(new Fe,Object.fromEntries(Object.entries(D).filter(([N,z])=>z!==null))))}}W(V,e=!1,e),l(2,o=!0),await le(),u&&(l(4,_=u.getInvalid()),l(3,p=!0))});const M=m=>{m.closest("#submissionSection")&&u.toggleSubsection("#submissionSection","open"),m.closest("#paymentSection")&&u.toggleSubsection("#paymentSection","open"),m.labels[0].scrollIntoView({behavior:"smooth",block:"center"}),Ne(m.labels[0])},c=()=>{l(3,p=!0),l(5,b=null),l(0,n=te({},U))},k=async()=>{l(3,p=!p&&(!d||await K())),(p||b)&&document.getElementById("back").click(),p&&u.closeSubsections(),l(7,U=!p&&!b?JSON.parse(JSON.stringify(n)):U)};function q(m){Z[m?"unshift":"push"](()=>{u=m,l(1,u)})}function E(m){n=m,l(0,n)}function ce(m){d=m,l(6,d)}return i.$$set=m=>{"dto"in m&&l(0,n=m.dto)},[n,u,o,p,_,b,d,U,e,f,a,K,M,c,k,q,E,ce]}class Ze extends de{constructor(t){super();ge(this,t,qe,Me,be,{dto:0})}}export{Ze as default};

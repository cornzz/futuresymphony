var _e=Object.defineProperty;var x=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var ee=(o,t,l)=>t in o?_e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[t]=l,te=(o,t)=>{for(var l in t||(t={}))pe.call(t,l)&&ee(o,l,t[l]);if(x)for(var l of x(t))me.call(t,l)&&ee(o,l,t[l]);return o};import{S as de,i as ge,s as be,e as L,t as y,j as S,k as K,c as A,a as P,g as v,d,l as O,b as z,f as $,F as E,h as F,n as w,o as T,p as k,J as Q,u as he,m as J,X as ke,T as le,ai as G,U as Z,H as W,v as I,w as R,x as B,A as C,aj as re,ak as oe,G as $e,ac as we}from"../../chunks/vendor-3b8c650a.js";import{a as Y}from"../../chunks/selectData-82a6e62f.js";import{a as ye,R as ve}from"../../chunks/RegistrationForm-0f06edce.js";import{B as se}from"../../chunks/Button-17e544cc.js";import{b as Fe,l as V,c as Se,d as Oe}from"../../chunks/stores-a1012c52.js";import{h as De}from"../../chunks/index-8490d5e5.js";function ie(o,t,l){const e=o.slice();return e[20]=t[l],e}function Ne(o){let t,l=o[9]("registration.notfound")+"",e,r,i,n=o[9]("error.goBack")+"",s;return{c(){t=L("div"),e=y(l),r=S(),i=L("a"),s=y(n),this.h()},l(u){t=A(u,"DIV",{class:!0});var f=P(t);e=v(f,l),r=O(f),i=A(f,"A",{href:!0,class:!0});var a=P(i);s=v(a,n),a.forEach(d),f.forEach(d),this.h()},h(){z(i,"href","/"),z(i,"class","link"),z(t,"class","center svelte-pts9xi")},m(u,f){$(u,t,f),E(t,e),E(t,r),E(t,i),E(i,s)},p(u,f){f&512&&l!==(l=u[9]("registration.notfound")+"")&&F(e,l),f&512&&n!==(n=u[9]("error.goBack")+"")&&F(s,n)},i:W,o:W,d(u){u&&d(t)}}}function je(o){let t,l,e,r,i,n,s,u,f,a=!o[10]&&ne(o);const g=[Re,Ie],_=[];function b(c,h){return c[4].length===0?0:1}l=b(o),e=_[l]=g[l](o);let m=o[5]&&ae(o);function U(c){o[16](c)}function X(c){o[17](c)}let H={disabled:o[3],$$slots:{default:[Je]},$$scope:{ctx:o}};return o[0]!==void 0&&(H.dto=o[0]),o[6]!==void 0&&(H.changed=o[6]),n=new ve({props:H}),o[15](n),Z.push(()=>re(n,"dto",U)),Z.push(()=>re(n,"changed",X)),{c(){a&&a.c(),t=S(),e.c(),r=S(),m&&m.c(),i=S(),I(n.$$.fragment)},l(c){a&&a.l(c),t=O(c),e.l(c),r=O(c),m&&m.l(c),i=O(c),R(n.$$.fragment,c)},m(c,h){a&&a.m(c,h),$(c,t,h),_[l].m(c,h),$(c,r,h),m&&m.m(c,h),$(c,i,h),B(n,c,h),f=!0},p(c,h){c[10]?a&&(J(),w(a,1,1,()=>{a=null}),T()):a?(a.p(c,h),h&1024&&k(a,1)):(a=ne(c),a.c(),k(a,1),a.m(t.parentNode,t));let M=l;l=b(c),l===M?_[l].p(c,h):(J(),w(_[M],1,1,()=>{_[M]=null}),T(),e=_[l],e?e.p(c,h):(e=_[l]=g[l](c),e.c()),k(e,1),e.m(r.parentNode,r)),c[5]?m?(m.p(c,h),h&32&&k(m,1)):(m=ae(c),m.c(),k(m,1),m.m(i.parentNode,i)):m&&(J(),w(m,1,1,()=>{m=null}),T());const N={};h&8&&(N.disabled=c[3]),h&8390635&&(N.$$scope={dirty:h,ctx:c}),!s&&h&1&&(s=!0,N.dto=c[0],oe(()=>s=!1)),!u&&h&64&&(u=!0,N.changed=c[6],oe(()=>u=!1)),n.$set(N)},i(c){f||(k(a),k(e),k(m),k(n.$$.fragment,c),f=!0)},o(c){w(a),w(e),w(m),w(n.$$.fragment,c),f=!1},d(c){a&&a.d(c),c&&d(t),_[l].d(c),c&&d(r),m&&m.d(c),c&&d(i),o[15](null),C(n,c)}}}function ne(o){let t,l;return t=new Y({props:{type:"info",$$slots:{default:[Ee]},$$scope:{ctx:o}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const i={};r&8389120&&(i.$$scope={dirty:r,ctx:e}),t.$set(i)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Ee(o){let t=o[9]("registration.editingAllowedUntil")+"",l,e,r=o[9]("registration.confirmationAfterDeadline")+"",i;return{c(){l=y(t),e=S(),i=y(r)},l(n){l=v(n,t),e=O(n),i=v(n,r)},m(n,s){$(n,l,s),$(n,e,s),$(n,i,s)},p(n,s){s&512&&t!==(t=n[9]("registration.editingAllowedUntil")+"")&&F(l,t),s&512&&r!==(r=n[9]("registration.confirmationAfterDeadline")+"")&&F(i,r)},d(n){n&&d(l),n&&d(e),n&&d(i)}}}function Ie(o){let t,l;return t=new Y({props:{type:"warning",$$slots:{default:[Be]},$$scope:{ctx:o}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const i={};r&8389138&&(i.$$scope={dirty:r,ctx:e}),t.$set(i)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Re(o){let t,l;return t=new Y({props:{type:"success",$$slots:{default:[Ce]},$$scope:{ctx:o}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const i={};r&8389120&&(i.$$scope={dirty:r,ctx:e}),t.$set(i)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function fe(o){let t,l=o[9](o[20].labels[0].dataset.label)+"",e,r,i,n;function s(){return o[12](o[20])}return{c(){t=L("li"),e=y(l),r=S(),this.h()},l(u){t=A(u,"LI",{class:!0});var f=P(t);e=v(f,l),r=O(f),f.forEach(d),this.h()},h(){z(t,"class","svelte-pts9xi")},m(u,f){$(u,t,f),E(t,e),E(t,r),i||(n=$e(t,"click",s),i=!0)},p(u,f){o=u,f&528&&l!==(l=o[9](o[20].labels[0].dataset.label)+"")&&F(e,l)},d(u){u&&d(t),i=!1,n()}}}function Be(o){let t=o[9]("registration.missingForComplete")+"",l,e,r,i=o[4],n=[];for(let s=0;s<i.length;s+=1)n[s]=fe(ie(o,i,s));return{c(){l=y(t),e=S(),r=L("ul");for(let s=0;s<n.length;s+=1)n[s].c()},l(s){l=v(s,t),e=O(s),r=A(s,"UL",{});var u=P(r);for(let f=0;f<n.length;f+=1)n[f].l(u);u.forEach(d)},m(s,u){$(s,l,u),$(s,e,u),$(s,r,u);for(let f=0;f<n.length;f+=1)n[f].m(r,null)},p(s,u){if(u&512&&t!==(t=s[9]("registration.missingForComplete")+"")&&F(l,t),u&530){i=s[4];let f;for(f=0;f<i.length;f+=1){const a=ie(s,i,f);n[f]?n[f].p(a,u):(n[f]=fe(a),n[f].c(),n[f].m(r,null))}for(;f<n.length;f+=1)n[f].d(1);n.length=i.length}},d(s){s&&d(l),s&&d(e),s&&d(r),we(n,s)}}}function Ce(o){let t=o[9]("registration.complete")+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){$(e,l,r)},p(e,r){r&512&&t!==(t=e[9]("registration.complete")+"")&&F(l,t)},d(e){e&&d(l)}}}function ae(o){let t,l;return t=new Y({props:{type:"error",$$slots:{default:[Ue]},$$scope:{ctx:o}}}),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const i={};r&8389152&&(i.$$scope={dirty:r,ctx:e}),t.$set(i)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Ue(o){let t=o[9](...o[5])+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){$(e,l,r)},p(e,r){r&544&&t!==(t=e[9](...e[5])+"")&&F(l,t)},d(e){e&&d(l)}}}function Le(o){let t;return{c(){t=L("div")},l(l){t=A(l,"DIV",{}),P(t).forEach(d)},m(l,e){$(l,t,e)},p:W,i:W,o:W,d(l){l&&d(t)}}}function Ae(o){let t,l;return t=new se({props:{type:"outline",disabled:o[8],$$slots:{default:[Pe]},$$scope:{ctx:o}}}),t.$on("click",o[13]),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const i={};r&256&&(i.disabled=e[8]),r&8389120&&(i.$$scope={dirty:r,ctx:e}),t.$set(i)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Pe(o){let t=o[9]("registration.form.cancel")+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){$(e,l,r)},p(e,r){r&512&&t!==(t=e[9]("registration.form.cancel")+"")&&F(l,t)},d(e){e&&d(l)}}}function ue(o){let t,l;return t=new se({props:{type:"primary",disabled:o[8],$$slots:{default:[Te]},$$scope:{ctx:o}}}),t.$on("click",o[14]),{c(){I(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const i={};r&256&&(i.disabled=e[8]),r&8389128&&(i.$$scope={dirty:r,ctx:e}),t.$set(i)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Te(o){let t=(o[3]?o[9]("registration.form.edit"):o[9]("registration.form.save"))+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){$(e,l,r)},p(e,r){r&520&&t!==(t=(e[3]?e[9]("registration.form.edit"):e[9]("registration.form.save"))+"")&&F(l,t)},d(e){e&&d(l)}}}function Je(o){let t,l,e,r,i;const n=[Ae,Le],s=[];function u(a,g){return a[3]?1:0}t=u(o),l=s[t]=n[t](o);let f=!o[10]&&ue(o);return{c(){l.c(),e=S(),f&&f.c(),r=K()},l(a){l.l(a),e=O(a),f&&f.l(a),r=K()},m(a,g){s[t].m(a,g),$(a,e,g),f&&f.m(a,g),$(a,r,g),i=!0},p(a,g){let _=t;t=u(a),t===_?s[t].p(a,g):(J(),w(s[_],1,1,()=>{s[_]=null}),T(),l=s[t],l?l.p(a,g):(l=s[t]=n[t](a),l.c()),k(l,1),l.m(e.parentNode,e)),a[10]?f&&(J(),w(f,1,1,()=>{f=null}),T()):f?(f.p(a,g),g&1024&&k(f,1)):(f=ue(a),f.c(),k(f,1),f.m(r.parentNode,r))},i(a){i||(k(l),k(f),i=!0)},o(a){w(l),w(f),i=!1},d(a){s[t].d(a),a&&d(e),f&&f.d(a),a&&d(r)}}}function Ve(o){let t,l=o[9]("registration.yourRegistration")+"",e,r,i,n,s,u;const f=[je,Ne],a=[];function g(_,b){return _[0]?0:_[2]?1:-1}return~(i=g(o))&&(n=a[i]=f[i](o)),{c(){t=L("h1"),e=y(l),r=S(),n&&n.c(),s=K(),this.h()},l(_){t=A(_,"H1",{class:!0});var b=P(t);e=v(b,l),b.forEach(d),r=O(_),n&&n.l(_),s=K(),this.h()},h(){z(t,"class","cover-heading")},m(_,b){$(_,t,b),E(t,e),$(_,r,b),~i&&a[i].m(_,b),$(_,s,b),u=!0},p(_,[b]){(!u||b&512)&&l!==(l=_[9]("registration.yourRegistration")+"")&&F(e,l);let m=i;i=g(_),i===m?~i&&a[i].p(_,b):(n&&(J(),w(a[m],1,1,()=>{a[m]=null}),T()),~i?(n=a[i],n?n.p(_,b):(n=a[i]=f[i](_),n.c()),k(n,1),n.m(s.parentNode,s)):n=null)},i(_){u||(k(n),u=!0)},o(_){w(n),u=!1},d(_){_&&d(t),_&&d(r),~i&&a[i].d(_),_&&d(s)}}}function He(o,t,l){let e,r,i,n;Q(o,V,p=>l(8,e=p)),Q(o,Se,p=>l(19,r=p)),Q(o,ke,p=>l(9,i=p)),Q(o,Oe,p=>l(10,n=p));let{dto:s=null}=t;Fe.set(!0);let u,f,a=!1,g=!1,_=[],b=null,m=!1,U=null;async function X(){if(l(5,b=null),await le(),u.reportValidity("#firstName, #lastName, #email, #dateOfBirth, #country, #idCopy, #pieceScore, #pieceDemo, #proofOfPayment")){console.log(`saving registration ${f}`),G(V,e=!0,e);let p=await fetch(new URL("registration.php",r),{method:"POST",body:JSON.stringify(s)}),D=await p.text();if(p.ok&&D==="Registration successfully updated."){let j=new FormData;j.append("reg_key",f);for(let q of Object.entries(s.files))q[1]&&j.append(q[0],q[1][0]);if(p=await fetch(new URL(`files.php?key=${f}`,r),{method:"POST",body:j}),D=await p.text(),p.ok&&D==="File upload successful.")return l(0,s.files.idCopyFile=void 0,s),l(0,s.files.pieceDemoFile=void 0,s),l(0,s.files.pieceScoreFile=void 0,s),l(0,s.files.proofOfPaymentFile=void 0,s),l(6,m=!1),G(V,e=!1,e),l(4,_=u.getInvalid()),!0}if(D==="Invalid form.")l(5,b=["registration.form.error.invalidForm",{}]);else if(D.startsWith("Invalid file type or size:")){const j=D.split(": ").pop();l(5,b=["registration.form.error.fileError",{values:{number:j.split(",").length,files:j}}])}else l(5,b=["registration.form.error.errorOccurred",{}]);G(V,e=!1,e)}return!1}he(async()=>{if(G(V,e=!0,e),f=window.location.search.substring(1),console.log(`loading registration ${f}`),f==="1")l(0,s=JSON.parse('{"reg_key":"1","firstName":"Ernst","lastName":"Haft","email":"ernsthaft@web.de","dateOfBirth":"2001-01-11","country":"DE","pieceTitle":"My piece","pieceDemo":"","pieceScore":"score.pdf","idCopy":"","instrumentation":[[true],[true],[true],[true],[true],[true],[true],[true,true],[false,true],[false],[true],[false],[true,true],[false],[false],[false],[false],[false],[true],[true,true,true,true,true,true],[true,true,true,true,false],[true,true,true,true],[true,false,false],[false,false]],"scoreConfirmations":[true,false,false],"proofOfPayment":"","files":{"idCopyFile":null,"pieceScoreFile":null,"pieceDemoFile":null,"proofOfPaymentFile":null}}'));else{const p=await fetch(new URL(`registration.php?key=${f}`,r));if(p.ok){const D=await p.json();l(0,s=Object.assign(new ye,Object.fromEntries(Object.entries(D).filter(([j,q])=>q!==null))))}}G(V,e=!1,e),l(2,a=!0),await le(),u&&(l(4,_=u.getInvalid()),l(3,g=!0))});const H=p=>{p.closest("#submissionSection")&&u.toggleSubsection("#submissionSection","open"),p.closest("#paymentSection")&&u.toggleSubsection("#paymentSection","open"),p.labels[0].scrollIntoView({behavior:"smooth",block:"center"}),De(p.labels[0])},c=()=>{l(3,g=!0),l(5,b=null),l(0,s=te({},U))},h=async()=>{l(3,g=!g&&(!m||await X())),(g||b)&&document.getElementById("back").click(),g&&u.closeSubsections(),l(7,U=!g&&!b?JSON.parse(JSON.stringify(s)):U)};function M(p){Z[p?"unshift":"push"](()=>{u=p,l(1,u)})}function N(p){s=p,l(0,s)}function ce(p){m=p,l(6,m)}return o.$$set=p=>{"dto"in p&&l(0,s=p.dto)},[s,u,a,g,_,b,m,U,e,i,n,X,H,c,h,M,N,ce]}class Qe extends de{constructor(t){super();ge(this,t,He,Ve,be,{dto:0})}}export{Qe as default};

var ue=Object.defineProperty;var x=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var ee=(i,t,l)=>t in i?ue(i,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[t]=l,te=(i,t)=>{for(var l in t||(t={}))ce.call(t,l)&&ee(i,l,t[l]);if(x)for(var l of x(t))_e.call(t,l)&&ee(i,l,t[l]);return i};import{S as pe,i as me,s as de,e as U,t as y,j as S,k as z,c as L,a as T,g as v,d,l as O,b as H,f as h,F as I,h as F,n as w,o as W,p as $,J as Y,u as ge,m as X,X as be,T as le,ai as M,U as Z,H as G,v as N,w as R,x as B,A as C,aj as re,ak as oe,G as he,ac as ke}from"../../chunks/vendor-3b8c650a.js";import{a as K}from"../../chunks/selectData-f7eb7e31.js";import{a as $e,R as we}from"../../chunks/RegistrationForm-6045f255.js";import{B as ie}from"../../chunks/Button-17e544cc.js";import{b as ye,l as A,c as ve}from"../../chunks/stores-1b619b13.js";import{h as Fe}from"../../chunks/index-14c4ccb3.js";function se(i,t,l){const e=i.slice();return e[20]=t[l],e}function Se(i){let t,l=i[9]("registration.notfound")+"",e,r,s,o=i[9]("error.goBack")+"",n;return{c(){t=U("div"),e=y(l),r=S(),s=U("a"),n=y(o),this.h()},l(c){t=L(c,"DIV",{class:!0});var f=T(t);e=v(f,l),r=O(f),s=L(f,"A",{href:!0,class:!0});var a=T(s);n=v(a,o),a.forEach(d),f.forEach(d),this.h()},h(){H(s,"href","/"),H(s,"class","link"),H(t,"class","center svelte-pts9xi")},m(c,f){h(c,t,f),I(t,e),I(t,r),I(t,s),I(s,n)},p(c,f){f&512&&l!==(l=c[9]("registration.notfound")+"")&&F(e,l),f&512&&o!==(o=c[9]("error.goBack")+"")&&F(n,o)},i:G,o:G,d(c){c&&d(t)}}}function Oe(i){let t,l,e,r,s,o,n,c,f,a=!i[10]&&De(i);const k=[Ie,Ee],_=[];function g(u,b){return u[4].length===0?0:1}l=g(i),e=_[l]=k[l](i);let p=i[5]&&fe(i);function Q(u){i[16](u)}function q(u){i[17](u)}let J={disabled:i[3],$$slots:{default:[Je]},$$scope:{ctx:i}};return i[0]!==void 0&&(J.dto=i[0]),i[6]!==void 0&&(J.changed=i[6]),o=new we({props:J}),i[15](o),Z.push(()=>re(o,"dto",Q)),Z.push(()=>re(o,"changed",q)),{c(){a&&a.c(),t=S(),e.c(),r=S(),p&&p.c(),s=S(),N(o.$$.fragment)},l(u){a&&a.l(u),t=O(u),e.l(u),r=O(u),p&&p.l(u),s=O(u),R(o.$$.fragment,u)},m(u,b){a&&a.m(u,b),h(u,t,b),_[l].m(u,b),h(u,r,b),p&&p.m(u,b),h(u,s,b),B(o,u,b),f=!0},p(u,b){u[10]||a.p(u,b);let P=l;l=g(u),l===P?_[l].p(u,b):(X(),w(_[P],1,1,()=>{_[P]=null}),W(),e=_[l],e?e.p(u,b):(e=_[l]=k[l](u),e.c()),$(e,1),e.m(r.parentNode,r)),u[5]?p?(p.p(u,b),b&32&&$(p,1)):(p=fe(u),p.c(),$(p,1),p.m(s.parentNode,s)):p&&(X(),w(p,1,1,()=>{p=null}),W());const j={};b&8&&(j.disabled=u[3]),b&8389611&&(j.$$scope={dirty:b,ctx:u}),!n&&b&1&&(n=!0,j.dto=u[0],oe(()=>n=!1)),!c&&b&64&&(c=!0,j.changed=u[6],oe(()=>c=!1)),o.$set(j)},i(u){f||($(a),$(e),$(p),$(o.$$.fragment,u),f=!0)},o(u){w(a),w(e),w(p),w(o.$$.fragment,u),f=!1},d(u){a&&a.d(u),u&&d(t),_[l].d(u),u&&d(r),p&&p.d(u),u&&d(s),i[15](null),C(o,u)}}}function De(i){let t,l;return t=new K({props:{type:"info",$$slots:{default:[je]},$$scope:{ctx:i}}}),{c(){N(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const s={};r&8389120&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function je(i){let t=i[9]("registration.editingAllowedUntil")+"",l,e,r=i[9]("registration.confirmationAfterDeadline")+"",s;return{c(){l=y(t),e=S(),s=y(r)},l(o){l=v(o,t),e=O(o),s=v(o,r)},m(o,n){h(o,l,n),h(o,e,n),h(o,s,n)},p(o,n){n&512&&t!==(t=o[9]("registration.editingAllowedUntil")+"")&&F(l,t),n&512&&r!==(r=o[9]("registration.confirmationAfterDeadline")+"")&&F(s,r)},d(o){o&&d(l),o&&d(e),o&&d(s)}}}function Ee(i){let t,l;return t=new K({props:{type:"warning",$$slots:{default:[Ne]},$$scope:{ctx:i}}}),{c(){N(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const s={};r&8389138&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Ie(i){let t,l;return t=new K({props:{type:"success",$$slots:{default:[Re]},$$scope:{ctx:i}}}),{c(){N(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const s={};r&8389120&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function ne(i){let t,l=i[9](i[20].labels[0].dataset.label)+"",e,r,s,o;function n(){return i[12](i[20])}return{c(){t=U("li"),e=y(l),r=S(),this.h()},l(c){t=L(c,"LI",{class:!0});var f=T(t);e=v(f,l),r=O(f),f.forEach(d),this.h()},h(){H(t,"class","svelte-pts9xi")},m(c,f){h(c,t,f),I(t,e),I(t,r),s||(o=he(t,"click",n),s=!0)},p(c,f){i=c,f&528&&l!==(l=i[9](i[20].labels[0].dataset.label)+"")&&F(e,l)},d(c){c&&d(t),s=!1,o()}}}function Ne(i){let t=i[9]("registration.missingForComplete")+"",l,e,r,s=i[4],o=[];for(let n=0;n<s.length;n+=1)o[n]=ne(se(i,s,n));return{c(){l=y(t),e=S(),r=U("ul");for(let n=0;n<o.length;n+=1)o[n].c()},l(n){l=v(n,t),e=O(n),r=L(n,"UL",{});var c=T(r);for(let f=0;f<o.length;f+=1)o[f].l(c);c.forEach(d)},m(n,c){h(n,l,c),h(n,e,c),h(n,r,c);for(let f=0;f<o.length;f+=1)o[f].m(r,null)},p(n,c){if(c&512&&t!==(t=n[9]("registration.missingForComplete")+"")&&F(l,t),c&530){s=n[4];let f;for(f=0;f<s.length;f+=1){const a=se(n,s,f);o[f]?o[f].p(a,c):(o[f]=ne(a),o[f].c(),o[f].m(r,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=s.length}},d(n){n&&d(l),n&&d(e),n&&d(r),ke(o,n)}}}function Re(i){let t=i[9]("registration.complete")+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&512&&t!==(t=e[9]("registration.complete")+"")&&F(l,t)},d(e){e&&d(l)}}}function fe(i){let t,l;return t=new K({props:{type:"error",$$slots:{default:[Be]},$$scope:{ctx:i}}}),{c(){N(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const s={};r&8389152&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Be(i){let t=i[9](...i[5])+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&544&&t!==(t=e[9](...e[5])+"")&&F(l,t)},d(e){e&&d(l)}}}function Ce(i){let t;return{c(){t=U("div")},l(l){t=L(l,"DIV",{}),T(t).forEach(d)},m(l,e){h(l,t,e)},p:G,i:G,o:G,d(l){l&&d(t)}}}function Ue(i){let t,l;return t=new ie({props:{type:"outline",disabled:i[8],$$slots:{default:[Le]},$$scope:{ctx:i}}}),t.$on("click",i[13]),{c(){N(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const s={};r&256&&(s.disabled=e[8]),r&8389120&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Le(i){let t=i[9]("registration.form.cancel")+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&512&&t!==(t=e[9]("registration.form.cancel")+"")&&F(l,t)},d(e){e&&d(l)}}}function Te(i){let t,l;return t=new ie({props:{type:"primary",disabled:i[8],$$slots:{default:[Ae]},$$scope:{ctx:i}}}),t.$on("click",i[14]),{c(){N(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,r){B(t,e,r),l=!0},p(e,r){const s={};r&256&&(s.disabled=e[8]),r&8389128&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){l||($(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){C(t,e)}}}function Ae(i){let t=(i[3]?i[9]("registration.form.edit"):i[9]("registration.form.save"))+"",l;return{c(){l=y(t)},l(e){l=v(e,t)},m(e,r){h(e,l,r)},p(e,r){r&520&&t!==(t=(e[3]?e[9]("registration.form.edit"):e[9]("registration.form.save"))+"")&&F(l,t)},d(e){e&&d(l)}}}function Je(i){let t,l,e,r,s;const o=[Ue,Ce],n=[];function c(a,k){return a[3]?1:0}t=c(i),l=n[t]=o[t](i);let f=!i[10]&&Te(i);return{c(){l.c(),e=S(),f&&f.c(),r=z()},l(a){l.l(a),e=O(a),f&&f.l(a),r=z()},m(a,k){n[t].m(a,k),h(a,e,k),f&&f.m(a,k),h(a,r,k),s=!0},p(a,k){let _=t;t=c(a),t===_?n[t].p(a,k):(X(),w(n[_],1,1,()=>{n[_]=null}),W(),l=n[t],l?l.p(a,k):(l=n[t]=o[t](a),l.c()),$(l,1),l.m(e.parentNode,e)),a[10]||f.p(a,k)},i(a){s||($(l),$(f),s=!0)},o(a){w(l),w(f),s=!1},d(a){n[t].d(a),a&&d(e),f&&f.d(a),a&&d(r)}}}function Pe(i){let t,l=i[9]("registration.yourRegistration")+"",e,r,s,o,n,c;const f=[Oe,Se],a=[];function k(_,g){return _[0]?0:_[2]?1:-1}return~(s=k(i))&&(o=a[s]=f[s](i)),{c(){t=U("h1"),e=y(l),r=S(),o&&o.c(),n=z(),this.h()},l(_){t=L(_,"H1",{class:!0});var g=T(t);e=v(g,l),g.forEach(d),r=O(_),o&&o.l(_),n=z(),this.h()},h(){H(t,"class","cover-heading")},m(_,g){h(_,t,g),I(t,e),h(_,r,g),~s&&a[s].m(_,g),h(_,n,g),c=!0},p(_,[g]){(!c||g&512)&&l!==(l=_[9]("registration.yourRegistration")+"")&&F(e,l);let p=s;s=k(_),s===p?~s&&a[s].p(_,g):(o&&(X(),w(a[p],1,1,()=>{a[p]=null}),W()),~s?(o=a[s],o?o.p(_,g):(o=a[s]=f[s](_),o.c()),$(o,1),o.m(n.parentNode,n)):o=null)},i(_){c||($(o),c=!0)},o(_){w(o),c=!1},d(_){_&&d(t),_&&d(r),~s&&a[s].d(_),_&&d(n)}}}function Ve(i,t,l){let e,r,s;Y(i,A,m=>l(8,e=m)),Y(i,ve,m=>l(19,r=m)),Y(i,be,m=>l(9,s=m));let{dto:o=null}=t;ye.set(!0);let n,c,f=!1,a=!1,k=[],_=null,g=!1,p=null,Q=new Date>new Date("Jun 30 2022 23:59:59 GMT+0200");async function q(){if(l(5,_=null),await le(),n.reportValidity("#firstName, #lastName, #email, #dateOfBirth, #country, #idCopy, #pieceScore, #pieceDemo, #proofOfPayment")){console.log(`saving registration ${c}`),M(A,e=!0,e);let m=await fetch(new URL("registration.php",r),{method:"POST",body:JSON.stringify(o)}),D=await m.text();if(m.ok&&D==="Registration successfully updated."){let E=new FormData;E.append("reg_key",c);for(let V of Object.entries(o.files))V[1]&&E.append(V[0],V[1][0]);if(m=await fetch(new URL(`files.php?key=${c}`,r),{method:"POST",body:E}),D=await m.text(),m.ok&&D==="File upload successful.")return l(0,o.files.idCopyFile=void 0,o),l(0,o.files.pieceDemoFile=void 0,o),l(0,o.files.pieceScoreFile=void 0,o),l(0,o.files.proofOfPaymentFile=void 0,o),l(6,g=!1),M(A,e=!1,e),l(4,k=n.getInvalid()),!0}if(D==="Invalid form.")l(5,_=["registration.form.error.invalidForm",{}]);else if(D.startsWith("Invalid file type or size:")){const E=D.split(": ").pop();l(5,_=["registration.form.error.fileError",{values:{number:E.split(",").length,files:E}}])}else l(5,_=["registration.form.error.errorOccurred",{}]);M(A,e=!1,e)}return!1}ge(async()=>{if(M(A,e=!0,e),c=window.location.search.substring(1),console.log(`loading registration ${c}`),c==="1")l(0,o=JSON.parse('{"reg_key":"1","firstName":"Ernst","lastName":"Haft","email":"ernsthaft@web.de","dateOfBirth":"2001-01-11","country":"DE","pieceTitle":"My piece","pieceDemo":"","pieceScore":"score.pdf","idCopy":"","instrumentation":[[true],[true],[true],[true],[true],[true],[true],[true,true],[false,true],[false],[true],[false],[true,true],[false],[false],[false],[false],[false],[true],[true,true,true,true,true,true],[true,true,true,true,false],[true,true,true,true],[true,false,false],[false,false]],"scoreConfirmations":[true,false,false],"proofOfPayment":"","files":{"idCopyFile":null,"pieceScoreFile":null,"pieceDemoFile":null,"proofOfPaymentFile":null}}'));else{const m=await fetch(new URL(`registration.php?key=${c}`,r));if(m.ok){const D=await m.json();l(0,o=Object.assign(new $e,Object.fromEntries(Object.entries(D).filter(([E,V])=>V!==null))))}}M(A,e=!1,e),l(2,f=!0),await le(),n&&(l(4,k=n.getInvalid()),l(3,a=!0))});const J=m=>{m.closest("#submissionSection")&&n.toggleSubsection("#submissionSection","open"),m.closest("#paymentSection")&&n.toggleSubsection("#paymentSection","open"),m.labels[0].scrollIntoView({behavior:"smooth",block:"center"}),Fe(m.labels[0])},u=()=>{l(3,a=!0),l(5,_=null),l(0,o=te({},p))},b=async()=>{l(3,a=!a&&(!g||await q())),(a||_)&&document.getElementById("back").click(),a&&n.closeSubsections(),l(7,p=!a&&!_?JSON.parse(JSON.stringify(o)):p)};function P(m){Z[m?"unshift":"push"](()=>{n=m,l(1,n)})}function j(m){o=m,l(0,o)}function ae(m){g=m,l(6,g)}return i.$$set=m=>{"dto"in m&&l(0,o=m.dto)},[o,n,f,a,k,_,g,p,e,s,Q,q,J,u,b,P,j,ae]}class Ke extends pe{constructor(t){super();me(this,t,Ve,Pe,de,{dto:0})}}export{Ke as default};

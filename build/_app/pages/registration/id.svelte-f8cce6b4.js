import{S as _e,i as me,s as pe,v as R,a as S,k as M,p as F,e as V,w as B,c as O,l as q,m as K,q as N,g as p,n as Q,x as C,b,G as P,r as D,t as w,d as H,f as k,A as T,H as X,o as ge,u as J,Z as ee,ad as G,N as x,Q as W,$ as te,a0 as le,a6 as de,a7 as be,a2 as he,J as ke}from"../../chunks/index-5b3145ec.js";import{a as Z}from"../../chunks/selectData-cc17e31a.js";import{a as $e,R as we}from"../../chunks/RegistrationForm-deafc4a0.js";import{B as fe}from"../../chunks/Button-0276f9ef.js";import{c as ye,l as j,e as ve,X as Se,d as Oe}from"../../chunks/stores-360d0bab.js";import{h as Fe}from"../../chunks/index-03e0140e.js";import{M as Ne}from"../../chunks/MetaTags-271be665.js";function re(s,t,l){const e=s.slice();return e[21]=t[l],e}function De(s){let t,l=s[10]("registration.notfound")+"",e,r,a,c=s[10]("error.goBack")+"",i;return{c(){t=M("div"),e=F(l),r=S(),a=M("a"),i=F(c),this.h()},l(f){t=q(f,"DIV",{class:!0});var n=K(t);e=N(n,l),r=O(n),a=q(n,"A",{href:!0,class:!0});var o=K(a);i=N(o,c),o.forEach(p),n.forEach(p),this.h()},h(){Q(a,"href","/"),Q(a,"class","link"),Q(t,"class","center svelte-pts9xi")},m(f,n){b(f,t,n),P(t,e),P(t,r),P(t,a),P(a,i)},p(f,n){n&1024&&l!==(l=f[10]("registration.notfound")+"")&&D(e,l),n&1024&&c!==(c=f[10]("error.goBack")+"")&&D(i,c)},i:W,o:W,d(f){f&&p(t)}}}function Ee(s){let t,l,e,r,a,c,i,f,n,o=!s[11]&&ie(s);const m=[Be,Re],d=[];function y(_,$){return _[4].length===0?0:1}l=y(s),e=d[l]=m[l](s);let u=s[5]&&se(s);function h(_){s[17](_)}function v(_){s[18](_)}let E={disabled:s[3],$$slots:{default:[He]},$$scope:{ctx:s}};return s[0]!==void 0&&(E.dto=s[0]),s[6]!==void 0&&(E.changed=s[6]),c=new we({props:E}),s[16](c),x.push(()=>te(c,"dto",h)),x.push(()=>te(c,"changed",v)),{c(){o&&o.c(),t=S(),e.c(),r=S(),u&&u.c(),a=S(),R(c.$$.fragment)},l(_){o&&o.l(_),t=O(_),e.l(_),r=O(_),u&&u.l(_),a=O(_),B(c.$$.fragment,_)},m(_,$){o&&o.m(_,$),b(_,t,$),d[l].m(_,$),b(_,r,$),u&&u.m(_,$),b(_,a,$),C(c,_,$),n=!0},p(_,$){_[11]?o&&(J(),w(o,1,1,()=>{o=null}),H()):o?(o.p(_,$),$&2048&&k(o,1)):(o=ie(_),o.c(),k(o,1),o.m(t.parentNode,t));let z=l;l=y(_),l===z?d[l].p(_,$):(J(),w(d[z],1,1,()=>{d[z]=null}),H(),e=d[l],e?e.p(_,$):(e=d[l]=m[l](_),e.c()),k(e,1),e.m(r.parentNode,r)),_[5]?u?(u.p(_,$),$&32&&k(u,1)):(u=se(_),u.c(),k(u,1),u.m(a.parentNode,a)):u&&(J(),w(u,1,1,()=>{u=null}),H());const L={};$&8&&(L.disabled=_[3]),$&16781291&&(L.$$scope={dirty:$,ctx:_}),!i&&$&1&&(i=!0,L.dto=_[0],le(()=>i=!1)),!f&&$&64&&(f=!0,L.changed=_[6],le(()=>f=!1)),c.$set(L)},i(_){n||(k(o),k(e),k(u),k(c.$$.fragment,_),n=!0)},o(_){w(o),w(e),w(u),w(c.$$.fragment,_),n=!1},d(_){o&&o.d(_),_&&p(t),d[l].d(_),_&&p(r),u&&u.d(_),_&&p(a),s[16](null),T(c,_)}}}function ie(s){let t,l;return t=new Z({props:{type:"info",$$slots:{default:[Ie]},$$scope:{ctx:s}}}),{c(){R(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,r){C(t,e,r),l=!0},p(e,r){const a={};r&16778240&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){T(t,e)}}}function Ie(s){let t=s[10]("registration.editingAllowedUntil")+"",l,e,r=s[10]("registration.confirmationAfterDeadline")+"",a,c,i,f=s[10]("registration.clickEdit")+"",n;return{c(){l=F(t),e=S(),a=F(r),c=S(),i=new de(!1),n=V(),this.h()},l(o){l=N(o,t),e=O(o),a=N(o,r),c=O(o),i=be(o,!1),n=V(),this.h()},h(){i.a=n},m(o,m){b(o,l,m),b(o,e,m),b(o,a,m),b(o,c,m),i.m(f,o,m),b(o,n,m)},p(o,m){m&1024&&t!==(t=o[10]("registration.editingAllowedUntil")+"")&&D(l,t),m&1024&&r!==(r=o[10]("registration.confirmationAfterDeadline")+"")&&D(a,r),m&1024&&f!==(f=o[10]("registration.clickEdit")+"")&&i.p(f)},d(o){o&&p(l),o&&p(e),o&&p(a),o&&p(c),o&&p(n),o&&i.d()}}}function Re(s){let t,l;return t=new Z({props:{type:"warning",$$slots:{default:[Ce]},$$scope:{ctx:s}}}),{c(){R(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,r){C(t,e,r),l=!0},p(e,r){const a={};r&16778258&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){T(t,e)}}}function Be(s){let t,l;return t=new Z({props:{type:"success",$$slots:{default:[Te]},$$scope:{ctx:s}}}),{c(){R(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,r){C(t,e,r),l=!0},p(e,r){const a={};r&16778240&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){T(t,e)}}}function oe(s){let t,l=s[10](s[21].labels[0].dataset.label)+"",e,r,a,c;function i(){return s[13](s[21])}return{c(){t=M("li"),e=F(l),r=S(),this.h()},l(f){t=q(f,"LI",{class:!0});var n=K(t);e=N(n,l),r=O(n),n.forEach(p),this.h()},h(){Q(t,"class","svelte-pts9xi")},m(f,n){b(f,t,n),P(t,e),P(t,r),a||(c=ke(t,"click",i),a=!0)},p(f,n){s=f,n&1040&&l!==(l=s[10](s[21].labels[0].dataset.label)+"")&&D(e,l)},d(f){f&&p(t),a=!1,c()}}}function Ce(s){let t=s[10]("registration.missingForComplete")+"",l,e,r,a=s[4],c=[];for(let i=0;i<a.length;i+=1)c[i]=oe(re(s,a,i));return{c(){l=F(t),e=S(),r=M("ul");for(let i=0;i<c.length;i+=1)c[i].c()},l(i){l=N(i,t),e=O(i),r=q(i,"UL",{});var f=K(r);for(let n=0;n<c.length;n+=1)c[n].l(f);f.forEach(p)},m(i,f){b(i,l,f),b(i,e,f),b(i,r,f);for(let n=0;n<c.length;n+=1)c[n].m(r,null)},p(i,f){if(f&1024&&t!==(t=i[10]("registration.missingForComplete")+"")&&D(l,t),f&1042){a=i[4];let n;for(n=0;n<a.length;n+=1){const o=re(i,a,n);c[n]?c[n].p(o,f):(c[n]=oe(o),c[n].c(),c[n].m(r,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=a.length}},d(i){i&&p(l),i&&p(e),i&&p(r),he(c,i)}}}function Te(s){let t=s[10]("registration.complete")+"",l;return{c(){l=F(t)},l(e){l=N(e,t)},m(e,r){b(e,l,r)},p(e,r){r&1024&&t!==(t=e[10]("registration.complete")+"")&&D(l,t)},d(e){e&&p(l)}}}function se(s){let t,l;return t=new Z({props:{type:"error",$$slots:{default:[Le]},$$scope:{ctx:s}}}),{c(){R(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,r){C(t,e,r),l=!0},p(e,r){const a={};r&16778272&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){T(t,e)}}}function Le(s){let t=s[10](...s[5])+"",l;return{c(){l=F(t)},l(e){l=N(e,t)},m(e,r){b(e,l,r)},p(e,r){r&1056&&t!==(t=e[10](...e[5])+"")&&D(l,t)},d(e){e&&p(l)}}}function Ue(s){let t;return{c(){t=M("div")},l(l){t=q(l,"DIV",{}),K(t).forEach(p)},m(l,e){b(l,t,e)},p:W,i:W,o:W,d(l){l&&p(t)}}}function Ae(s){let t,l;return t=new fe({props:{type:"outline",disabled:s[9],$$slots:{default:[Pe]},$$scope:{ctx:s}}}),t.$on("click",s[14]),{c(){R(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,r){C(t,e,r),l=!0},p(e,r){const a={};r&512&&(a.disabled=e[9]),r&16778240&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){T(t,e)}}}function Pe(s){let t=s[10]("registration.form.cancel")+"",l;return{c(){l=F(t)},l(e){l=N(e,t)},m(e,r){b(e,l,r)},p(e,r){r&1024&&t!==(t=e[10]("registration.form.cancel")+"")&&D(l,t)},d(e){e&&p(l)}}}function ne(s){let t,l;return t=new fe({props:{type:"primary",disabled:s[9],$$slots:{default:[je]},$$scope:{ctx:s}}}),t.$on("click",s[15]),{c(){R(t.$$.fragment)},l(e){B(t.$$.fragment,e)},m(e,r){C(t,e,r),l=!0},p(e,r){const a={};r&512&&(a.disabled=e[9]),r&16778248&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){w(t.$$.fragment,e),l=!1},d(e){T(t,e)}}}function je(s){let t=(s[3]?s[10]("registration.form.edit"):s[10]("registration.form.save"))+"",l;return{c(){l=F(t)},l(e){l=N(e,t)},m(e,r){b(e,l,r)},p(e,r){r&1032&&t!==(t=(e[3]?e[10]("registration.form.edit"):e[10]("registration.form.save"))+"")&&D(l,t)},d(e){e&&p(l)}}}function He(s){let t,l,e,r,a;const c=[Ae,Ue],i=[];function f(o,m){return o[3]?1:0}t=f(s),l=i[t]=c[t](s);let n=(!s[11]||s[8])&&ne(s);return{c(){l.c(),e=S(),n&&n.c(),r=V()},l(o){l.l(o),e=O(o),n&&n.l(o),r=V()},m(o,m){i[t].m(o,m),b(o,e,m),n&&n.m(o,m),b(o,r,m),a=!0},p(o,m){let d=t;t=f(o),t===d?i[t].p(o,m):(J(),w(i[d],1,1,()=>{i[d]=null}),H(),l=i[t],l?l.p(o,m):(l=i[t]=c[t](o),l.c()),k(l,1),l.m(e.parentNode,e)),!o[11]||o[8]?n?(n.p(o,m),m&2304&&k(n,1)):(n=ne(o),n.c(),k(n,1),n.m(r.parentNode,r)):n&&(J(),w(n,1,1,()=>{n=null}),H())},i(o){a||(k(l),k(n),a=!0)},o(o){w(l),w(n),a=!1},d(o){i[t].d(o),o&&p(e),n&&n.d(o),o&&p(r)}}}function Je(s){let t,l,e,r=s[10]("registration.yourRegistration")+"",a,c,i,f,n,o;t=new Ne({props:{title:s[10]("registration.meta.yourRegistrationTitle"),description:s[10]("registration.meta.description")}});const m=[Ee,De],d=[];function y(u,h){return u[0]?0:u[2]?1:-1}return~(i=y(s))&&(f=d[i]=m[i](s)),{c(){R(t.$$.fragment),l=S(),e=M("h1"),a=F(r),c=S(),f&&f.c(),n=V(),this.h()},l(u){B(t.$$.fragment,u),l=O(u),e=q(u,"H1",{class:!0});var h=K(e);a=N(h,r),h.forEach(p),c=O(u),f&&f.l(u),n=V(),this.h()},h(){Q(e,"class","cover-heading")},m(u,h){C(t,u,h),b(u,l,h),b(u,e,h),P(e,a),b(u,c,h),~i&&d[i].m(u,h),b(u,n,h),o=!0},p(u,[h]){const v={};h&1024&&(v.title=u[10]("registration.meta.yourRegistrationTitle")),h&1024&&(v.description=u[10]("registration.meta.description")),t.$set(v),(!o||h&1024)&&r!==(r=u[10]("registration.yourRegistration")+"")&&D(a,r);let E=i;i=y(u),i===E?~i&&d[i].p(u,h):(f&&(J(),w(d[E],1,1,()=>{d[E]=null}),H()),~i?(f=d[i],f?f.p(u,h):(f=d[i]=m[i](u),f.c()),k(f,1),f.m(n.parentNode,n)):f=null)},i(u){o||(k(t.$$.fragment,u),k(f),o=!0)},o(u){w(t.$$.fragment,u),w(f),o=!1},d(u){T(t,u),u&&p(l),u&&p(e),u&&p(c),~i&&d[i].d(u),u&&p(n)}}}function Me(s,t,l){let e,r,a,c;X(s,j,g=>l(9,e=g)),X(s,ve,g=>l(20,r=g)),X(s,Se,g=>l(10,a=g)),X(s,Oe,g=>l(11,c=g));let{dto:i=null}=t;ye.set(!0);let f,n,o=!1,m=!1,d=[],y=null,u=!1,h=null,v;async function E(){if(l(5,y=null),await ee(),f.reportValidity("#firstName, #lastName, #email, #dateOfBirth, #country, #idCopy, #pieceScore, #pieceDemo, #proofOfPayment")){console.log(`saving registration ${n}`),G(j,e=!0,e);const g="registration.php"+(v?`?admin=${v}`:"");let U=await fetch(new URL(g,r),{method:"POST",body:JSON.stringify(i)}),A=await U.text();if(U.ok&&A==="Registration successfully updated."){let I=new FormData;I.append("reg_key",n);for(let Y of Object.entries(i.files))Y[1]&&I.append(Y[0],Y[1][0]);const ce="files.php"+(v?`?admin=${v}`:"");if(U=await fetch(new URL(ce,r),{method:"POST",body:I}),A=await U.text(),U.ok&&A==="File upload successful.")return l(0,i.files.idCopyFile=void 0,i),l(0,i.files.pieceDemoFile=void 0,i),l(0,i.files.pieceScoreFile=void 0,i),l(0,i.files.proofOfPaymentFile=void 0,i),l(6,u=!1),G(j,e=!1,e),l(4,d=f.getInvalid()),!0}if(A==="Invalid form.")l(5,y=["registration.form.error.invalidForm",{}]);else if(A.startsWith("Invalid file type or size:")){const I=A.split(": ").pop();l(5,y=["registration.form.error.fileError",{values:{number:I.split(",").length,files:I}}])}else l(5,y=["registration.form.error.errorOccurred",{}]);G(j,e=!1,e)}return!1}ge(async()=>{if(G(j,e=!0,e),n=window.location.search.substring(1),console.log(`loading registration ${n}`),n==="1")l(0,i=JSON.parse('{"reg_key":"1","firstName":"Ernst","lastName":"Haft","email":"ernsthaft@web.de","dateOfBirth":"2001-01-11","country":"DE","pieceTitle":"My piece","pieceDemo":"","pieceScore":"score.pdf","idCopy":"","instrumentation":[[true],[true],[true],[true],[true],[true],[true],[true,true],[false,true],[false],[true],[false],[true,true],[false],[false],[false],[false],[false],[true],[true,true,true,true,true,true],[true,true,true,true,false],[true,true,true,true],[true,false,false],[false,false]],"scoreConfirmations":[true,false,false],"proofOfPayment":"","files":{"idCopyFile":null,"pieceScoreFile":null,"pieceDemoFile":null,"proofOfPaymentFile":null}}'));else{const g=await fetch(new URL(`registration.php?key=${n}`,r));if(g.ok){const U=await g.json();l(0,i=Object.assign(new $e,Object.fromEntries(Object.entries(U).filter(([A,I])=>I!==null))))}}G(j,e=!1,e),l(2,o=!0),await ee(),f&&(l(4,d=f.getInvalid()),l(3,m=!0)),l(8,v=localStorage.getItem("adminKey"))});const _=g=>{g.closest("#submissionSection")&&f.toggleSubsection("#submissionSection","open"),g.closest("#paymentSection")&&f.toggleSubsection("#paymentSection","open"),g.labels[0].scrollIntoView({behavior:"smooth",block:"center"}),Fe(g.labels[0])},$=()=>{l(3,m=!0),l(5,y=null),l(0,i={...h})},z=async()=>{l(3,m=!m&&(!u||await E())),(m||y)&&document.getElementById("back").click(),m&&f.closeSubsections(),l(7,h=!m&&!y?JSON.parse(JSON.stringify(i)):h)};function L(g){x[g?"unshift":"push"](()=>{f=g,l(1,f)})}function ae(g){i=g,l(0,i)}function ue(g){u=g,l(6,u)}return s.$$set=g=>{"dto"in g&&l(0,i=g.dto)},[i,f,o,m,d,y,u,h,v,e,a,c,E,_,$,z,L,ae,ue]}class Xe extends _e{constructor(t){super(),me(this,t,Me,Je,pe,{dto:0})}}export{Xe as default};

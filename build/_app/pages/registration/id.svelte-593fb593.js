import{S as oe,i as ie,s as le,e as I,t as y,j as D,k as X,c as N,a as j,g as v,d as m,l as B,b as J,f as h,F as E,h as F,n as w,o as q,p as k,J as W,u as ne,m as G,X as se,P as fe,a4 as H,Q as K,H as M,v as C,w as R,x as A,A as P,a5 as Y,a6 as Z,a0 as ae}from"../../chunks/vendor-9dd5214f.js";import{R as ue,a as ce,I as Q}from"../../chunks/RegistrationForm-4133092e.js";import{B as x}from"../../chunks/Button-592b1c8f.js";import{b as _e,l as T}from"../../chunks/stores-a341651b.js";import"../../chunks/index-7a26b117.js";function ee(s,t,r){const e=s.slice();return e[17]=t[r],e}function pe(s){let t,r=s[7]("registration.notfound")+"",e,o,i,l=s[7]("error.goBack")+"",n;return{c(){t=I("div"),e=y(r),o=D(),i=I("a"),n=y(l),this.h()},l(c){t=N(c,"DIV",{class:!0});var f=j(t);e=v(f,r),o=B(f),i=N(f,"A",{href:!0,class:!0});var a=j(i);n=v(a,l),a.forEach(m),f.forEach(m),this.h()},h(){J(i,"href","/"),J(i,"class","link"),J(t,"class","center svelte-3a7dix")},m(c,f){h(c,t,f),E(t,e),E(t,o),E(t,i),E(i,n)},p(c,f){f&128&&r!==(r=c[7]("registration.notfound")+"")&&F(e,r),f&128&&l!==(l=c[7]("error.goBack")+"")&&F(n,l)},i:M,o:M,d(c){c&&m(t)}}}function me(s){let t,r,e,o,i,l,n,c,f,a=!s[8]&&de(s);const d=[$e,be],b=[];function p(u,$){return u[4].length===0?0:1}r=p(s),e=b[r]=d[r](s);let _=s[5]&&re(s);function O(u){s[13](u)}function z(u){s[14](u)}let L={disabled:s[3],$$slots:{default:[De]},$$scope:{ctx:s}};return s[0]!==void 0&&(L.dto=s[0]),s[6]!==void 0&&(L.changed=s[6]),l=new ce({props:L}),s[12](l),K.push(()=>Y(l,"dto",O)),K.push(()=>Y(l,"changed",z)),{c(){a&&a.c(),t=D(),e.c(),o=D(),_&&_.c(),i=D(),C(l.$$.fragment)},l(u){a&&a.l(u),t=B(u),e.l(u),o=B(u),_&&_.l(u),i=B(u),R(l.$$.fragment,u)},m(u,$){a&&a.m(u,$),h(u,t,$),b[r].m(u,$),h(u,o,$),_&&_.m(u,$),h(u,i,$),A(l,u,$),f=!0},p(u,$){u[8]||a.p(u,$);let g=r;r=p(u),r===g?b[r].p(u,$):(G(),w(b[g],1,1,()=>{b[g]=null}),q(),e=b[r],e?e.p(u,$):(e=b[r]=d[r](u),e.c()),k(e,1),e.m(o.parentNode,o)),u[5]?_?(_.p(u,$),$&32&&k(_,1)):(_=re(u),_.c(),k(_,1),_.m(i.parentNode,i)):_&&(G(),w(_,1,1,()=>{_=null}),q());const S={};$&8&&(S.disabled=u[3]),$&1048810&&(S.$$scope={dirty:$,ctx:u}),!n&&$&1&&(n=!0,S.dto=u[0],Z(()=>n=!1)),!c&&$&64&&(c=!0,S.changed=u[6],Z(()=>c=!1)),l.$set(S)},i(u){f||(k(a),k(e),k(_),k(l.$$.fragment,u),f=!0)},o(u){w(a),w(e),w(_),w(l.$$.fragment,u),f=!1},d(u){a&&a.d(u),u&&m(t),b[r].d(u),u&&m(o),_&&_.d(u),u&&m(i),s[12](null),P(l,u)}}}function de(s){let t,r;return t=new Q({props:{type:"info",$$slots:{default:[ge]},$$scope:{ctx:s}}}),{c(){C(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,o){A(t,e,o),r=!0},p(e,o){const i={};o&1048704&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){P(t,e)}}}function ge(s){let t=s[7]("registration.editingAllowedUntil")+"",r,e,o=s[7]("registration.confirmationAfterDeadline")+"",i;return{c(){r=y(t),e=D(),i=y(o)},l(l){r=v(l,t),e=B(l),i=v(l,o)},m(l,n){h(l,r,n),h(l,e,n),h(l,i,n)},p(l,n){n&128&&t!==(t=l[7]("registration.editingAllowedUntil")+"")&&F(r,t),n&128&&o!==(o=l[7]("registration.confirmationAfterDeadline")+"")&&F(i,o)},d(l){l&&m(r),l&&m(e),l&&m(i)}}}function be(s){let t,r;return t=new Q({props:{type:"warning",$$slots:{default:[he]},$$scope:{ctx:s}}}),{c(){C(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,o){A(t,e,o),r=!0},p(e,o){const i={};o&1048720&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){P(t,e)}}}function $e(s){let t,r;return t=new Q({props:{type:"success",$$slots:{default:[ke]},$$scope:{ctx:s}}}),{c(){C(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,o){A(t,e,o),r=!0},p(e,o){const i={};o&1048704&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){P(t,e)}}}function te(s){let t,r=s[7](s[17])+"",e;return{c(){t=I("li"),e=y(r),this.h()},l(o){t=N(o,"LI",{class:!0});var i=j(t);e=v(i,r),i.forEach(m),this.h()},h(){J(t,"class","svelte-3a7dix")},m(o,i){h(o,t,i),E(t,e)},p(o,i){i&144&&r!==(r=o[7](o[17])+"")&&F(e,r)},d(o){o&&m(t)}}}function he(s){let t=s[7]("registration.missingForComplete")+"",r,e,o,i=s[4],l=[];for(let n=0;n<i.length;n+=1)l[n]=te(ee(s,i,n));return{c(){r=y(t),e=D(),o=I("ul");for(let n=0;n<l.length;n+=1)l[n].c()},l(n){r=v(n,t),e=B(n),o=N(n,"UL",{});var c=j(o);for(let f=0;f<l.length;f+=1)l[f].l(c);c.forEach(m)},m(n,c){h(n,r,c),h(n,e,c),h(n,o,c);for(let f=0;f<l.length;f+=1)l[f].m(o,null)},p(n,c){if(c&128&&t!==(t=n[7]("registration.missingForComplete")+"")&&F(r,t),c&144){i=n[4];let f;for(f=0;f<i.length;f+=1){const a=ee(n,i,f);l[f]?l[f].p(a,c):(l[f]=te(a),l[f].c(),l[f].m(o,null))}for(;f<l.length;f+=1)l[f].d(1);l.length=i.length}},d(n){n&&m(r),n&&m(e),n&&m(o),ae(l,n)}}}function ke(s){let t=s[7]("registration.complete")+"",r;return{c(){r=y(t)},l(e){r=v(e,t)},m(e,o){h(e,r,o)},p(e,o){o&128&&t!==(t=e[7]("registration.complete")+"")&&F(r,t)},d(e){e&&m(r)}}}function re(s){let t,r;return t=new Q({props:{type:"error",$$slots:{default:[we]},$$scope:{ctx:s}}}),{c(){C(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,o){A(t,e,o),r=!0},p(e,o){const i={};o&1048736&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){P(t,e)}}}function we(s){let t=s[7](s[5])+"",r;return{c(){r=y(t)},l(e){r=v(e,t)},m(e,o){h(e,r,o)},p(e,o){o&160&&t!==(t=e[7](e[5])+"")&&F(r,t)},d(e){e&&m(r)}}}function ye(s){let t;return{c(){t=I("div")},l(r){t=N(r,"DIV",{}),j(t).forEach(m)},m(r,e){h(r,t,e)},p:M,i:M,o:M,d(r){r&&m(t)}}}function ve(s){let t,r;return t=new x({props:{type:"outline",$$slots:{default:[Fe]},$$scope:{ctx:s}}}),t.$on("click",s[10]),{c(){C(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,o){A(t,e,o),r=!0},p(e,o){const i={};o&1048704&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){P(t,e)}}}function Fe(s){let t=s[7]("registration.form.cancel")+"",r;return{c(){r=y(t)},l(e){r=v(e,t)},m(e,o){h(e,r,o)},p(e,o){o&128&&t!==(t=e[7]("registration.form.cancel")+"")&&F(r,t)},d(e){e&&m(r)}}}function Oe(s){let t,r;return t=new x({props:{type:"primary",$$slots:{default:[Se]},$$scope:{ctx:s}}}),t.$on("click",s[11]),{c(){C(t.$$.fragment)},l(e){R(t.$$.fragment,e)},m(e,o){A(t,e,o),r=!0},p(e,o){const i={};o&1048712&&(i.$$scope={dirty:o,ctx:e}),t.$set(i)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){P(t,e)}}}function Se(s){let t=(s[3]?s[7]("registration.form.edit"):s[7]("registration.form.save"))+"",r;return{c(){r=y(t)},l(e){r=v(e,t)},m(e,o){h(e,r,o)},p(e,o){o&136&&t!==(t=(e[3]?e[7]("registration.form.edit"):e[7]("registration.form.save"))+"")&&F(r,t)},d(e){e&&m(r)}}}function De(s){let t,r,e,o,i;const l=[ve,ye],n=[];function c(a,d){return a[3]?1:0}t=c(s),r=n[t]=l[t](s);let f=!s[8]&&Oe(s);return{c(){r.c(),e=D(),f&&f.c(),o=X()},l(a){r.l(a),e=B(a),f&&f.l(a),o=X()},m(a,d){n[t].m(a,d),h(a,e,d),f&&f.m(a,d),h(a,o,d),i=!0},p(a,d){let b=t;t=c(a),t===b?n[t].p(a,d):(G(),w(n[b],1,1,()=>{n[b]=null}),q(),r=n[t],r?r.p(a,d):(r=n[t]=l[t](a),r.c()),k(r,1),r.m(e.parentNode,e)),a[8]||f.p(a,d)},i(a){i||(k(r),k(f),i=!0)},o(a){w(r),w(f),i=!1},d(a){n[t].d(a),a&&m(e),f&&f.d(a),a&&m(o)}}}function Be(s){let t,r,e=s[7]("registration.yourRegistration")+"",o,i,l,n,c,f;const a=[me,pe],d=[];function b(p,_){return p[0]?0:p[2]?1:-1}return~(l=b(s))&&(n=d[l]=a[l](s)),{c(){t=I("h1"),r=I("b"),o=y(e),i=D(),n&&n.c(),c=X(),this.h()},l(p){t=N(p,"H1",{class:!0});var _=j(t);r=N(_,"B",{});var O=j(r);o=v(O,e),O.forEach(m),_.forEach(m),i=B(p),n&&n.l(p),c=X(),this.h()},h(){J(t,"class","cover-heading")},m(p,_){h(p,t,_),E(t,r),E(r,o),h(p,i,_),~l&&d[l].m(p,_),h(p,c,_),f=!0},p(p,[_]){(!f||_&128)&&e!==(e=p[7]("registration.yourRegistration")+"")&&F(o,e);let O=l;l=b(p),l===O?~l&&d[l].p(p,_):(n&&(G(),w(d[O],1,1,()=>{d[O]=null}),q()),~l?(n=d[l],n?n.p(p,_):(n=d[l]=a[l](p),n.c()),k(n,1),n.m(c.parentNode,c)):n=null)},i(p){f||(k(n),f=!0)},o(p){w(n),f=!1},d(p){p&&m(t),p&&m(i),~l&&d[l].d(p),p&&m(c)}}}function Ie(s,t,r){let e,o;W(s,T,g=>r(16,e=g)),W(s,se,g=>r(7,o=g));let{dto:i=null}=t;_e.set(!0);let l,n,c=!1,f=!1,a=[],d="",b=!1,p=new Date>new Date("Jun 30 2022 23:59:59 GMT+0200");async function _(){if(r(5,d=""),await fe(),l.reportValidity("#firstName, #lastName, #email, #dateOfBirth, #country, #idCopy, #pieceScore, #pieceDemo, #proofOfPayment")){r(4,a=l.getInvalid()),console.log(`saving registration ${n}`),H(T,e=!0,e);let g=await fetch(new URL(`registration.php?key=${n}`,`${window.location.origin}/api/`).toString(),{method:"POST",body:JSON.stringify(i)});if(g.status===200){let V=new FormData;V.append("reg_key",n);for(let U of Object.entries(i.files))U[1]&&V.append(U[0],U[1][0]);if(g=await fetch(new URL(`files.php?key=${n}`,`${window.location.origin}/api/`).toString(),{method:"POST",body:V}),g.status===200)return r(0,i.files.idCopyFile=void 0,i),r(0,i.files.pieceDemoFile=void 0,i),r(0,i.files.pieceScoreFile=void 0,i),r(0,i.files.proofOfPaymentFile=void 0,i),r(6,b=!1),H(T,e=!1,e),!0}await g.text()==="Invalid form."?r(5,d="registration.form.error.invalidForm"):r(5,d="registration.form.error.errorOccurred"),H(T,e=!1,e)}return!1}ne(async()=>{if(H(T,e=!0,e),n=window.location.search.substring(1),console.log(`loading registration ${n}`),n==="1")r(0,i=JSON.parse('{"reg_key":"1","firstName":"Ernst","lastName":"Haft","email":"ernsthaft@web.de","dateOfBirth":"2001-01-11","country":"AX","pieceTitle":"My piece","pieceDemo":"","pieceScore":"score.pdf","idCopy":"","instrumentation":[[true],[true],[true],[true],[true],[true],[true],[true,true],[false,true],[false],[true],[false],[true,true],[false],[false],[false],[false],[false],[true],[true,true,true,true,true,true],[true,true,true,true,false],[true,true,true,true],[true,false,false],[false,false]],"scoreConfirmations":[true,false,false],"proofOfPayment":"proof.pdf","files":{"idCopyFile":null,"pieceScoreFile":null,"pieceDemoFile":null,"proofOfPaymentFile":null}}'));else{const g=await fetch(new URL(`registration.php?key=${n}`,`${window.location.origin}/api/`).toString());if(g.status===200){let S=JSON.parse(await g.text());r(0,i=Object.assign(new ue,Object.fromEntries(Object.entries(S).filter(([V,U])=>U!==null))))}}H(T,e=!1,e),r(2,c=!0)});const O=()=>r(3,f=!0),z=async()=>{r(3,f=!f&&(!b||await _())),(f||d)&&document.getElementById("back").click(),f&&l.closeSubsections()};function L(g){K[g?"unshift":"push"](()=>{l=g,r(1,l)})}function u(g){i=g,r(0,i)}function $(g){b=g,r(6,b)}return s.$$set=g=>{"dto"in g&&r(0,i=g.dto)},s.$$.update=()=>{s.$$.dirty&2&&l&&(r(4,a=l.getInvalid()),r(3,f=!0))},[i,l,c,f,a,d,b,o,p,_,O,z,L,u,$]}class Ae extends oe{constructor(t){super();ie(this,t,Ie,Be,le,{dto:0})}}export{Ae as default};
